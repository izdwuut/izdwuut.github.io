<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Create your own Youtube Thumbnail Downloader in Python - izdwuut's personal place</title><meta name=description content="The idea is pretty simple. Given the URL to a Youtube video, the script spews out it&rsquo;s thumbnail. See this lovely image? It would make for a perfect wallpaper and I wrote a script that does just that.
How would Python render it possible, you&rsquo;d ask? By working hand-in-hand with Youtube API, of course! I should seriously reconsider becoming a clown. I have a hunch that it would come as natural to me."><meta name=author content="izdwuut"><link rel=stylesheet href=/css/bundle.min.277d2cec16dea5cb8a23754f9b4fb21239187cb45a8ca3269e8ac6831bd12bc8.css integrity="sha256-J30s7BbepcuKI3VPm0+yEjkYfLRajKMmnorGgxvRK8g="><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.png><meta name=generator content="Hugo 0.75.1"><link rel=alternate type=application/atom+xml href=/index.xml title="izdwuut's personal place"></head><body class=single><header class=header><button type=button onclick=openNav() class=menu-toggle></button><nav class=sidenav id=mySidenav><a href=javascript:void(0) class=closebtn onclick=closeNav()>&#215;</a><ul><li><a href=/>Home</a></li><li><a href=/tutorials/>Tutorials</a></li><li><a href=/bugs/>Reported bugs</a></li><li><a href=/reviews/>Reviews</a></li><li><a href=/about/>About me</a></li></ul></nav><p class=title><a href=/>izdwuut's personal place</a></p></header><main class=main id=main><article class="post post-view"><header class=post-header><h1 class=post-title>Create your own Youtube Thumbnail Downloader in Python</h1><p class=post-meta><p class=post-meta>Written on 2020-02-21
by izdwuut.</p></p><div class=tags><ul class=post-tags><li><a href=/tags/python/>Python</a></li><li><a href=/tags/api/>API</a></li><li><a href=/tags/http/>HTTP</a></li><li><a href=/tags/cli/>CLI</a></li><li><a href=/tags/repl/>REPL</a></li><li><a href=/tags/tutorial/>Tutorial</a></li></ul></div></header><div class=tutorial-meta><div class=topics><h3>Topics covered</h3><ul><li>HTTP requests</li><li>Python standard library</li><li>API</li><li>CLI</li><li>REPL</li><li>Config files</li><li>Refactoring</li></ul></div><div class=pre-req><h3>Used libraries</h3><ul><li>argparse</li><li>google-api-python-client</li><li>configparser</li><li>urllib</li><li>json</li></ul></div><footer class=sources><i class="fab fa-github"></i><a href=https://github.com/izdwuut/uthumer>Sources</a></footer></div><div class=post-content><p>The idea is pretty simple. Given the URL to a Youtube video, the script spews out it&rsquo;s thumbnail. <a href="https://www.youtube.com/watch?v=U-iEK0mlmuQ">See this lovely image?</a> It would make for a perfect wallpaper and I wrote a script that does just that.</p><p>How would Python render it possible, you&rsquo;d ask? By working hand-in-hand with <a href=https://developers.google.com/youtube/v3/>Youtube API</a>, of course! I should seriously reconsider becoming a clown. I have a hunch that it would come as natural to me. Let&rsquo;s face it - my nose naturally turns red when it&rsquo;s cold and my feet are enormously large. Which implies&mldr;</p><h2 id=is-it-by-chance-an-apple-pie>Is it by chance an apple pie?</h2><p>&mldr;that they would fit those funky clown shoes just perfectly. Oh, the pie. <em>Right</em>.</p><p>API stands for <em>Application Programming Interface</em>. Be prepared for more mumbo-jumbo gibberish down the road. When I use the term, I mean a subset of a service&rsquo;s funcionality that your script can make use of. The use case covered by this tutorial can be brought to life because Youtube API <strong>(the service)</strong> provides an endpoint to download the thumbnail given the video ID. Programmatically speaking it&rsquo;s nothing more than a function. It yields some output <strong>(the thumbnail)</strong> given some parameters <strong>(the Youtube video ID)</strong> or lack thereof.</p><p>To interact with aforementioned API we are going to use a <a href=https://developers.google.com/api-client-library/python/start/get_started>Google API</a> wrapper - a Python abstraction for the API. It acts like any other library and I believe that it greatly simplifies the task as it doesn&rsquo;t require performing a HTTP call explicitly.</p><p>We are also going to need an API key - our license to use the interface. <a href=https://developers.google.com/youtube/v3/getting-started#before-you-start>Here</a> are detailed instruction on how to obtain it. You will be prompted for your project name. In case you were looking for a catchy name, you should be fine with <em>big-potential-216709</em>.</p><h1 id=installing-the-wraper>Installing the wraper</h1><p>The wrapper can be conveniently installed from a <a href=https://en.wikipedia.org/wiki/Command-line_interface>CLI</a> using pip - the default Python&rsquo;s package manager. First we need to create a virtual environment. It has it&rsquo;s advantages. For example it allows two projects to depend on different versions of the same packages. It&rsquo;s not necessary, as we could install our packages in global scope, although it&rsquo;s useful.</p><p>Invoke the following command to create the virtual environment in directory <code>venv</code>:</p><pre><code>python -m venv venv
</code></pre><p>Invoke the below to activate the virtual env (I assume that you run it on Windows using Powershell):</p><pre><code>.\venv\Scripts\activate.ps1
</code></pre><p>The shell should now display <code>(venv)</code> in front of current directory:</p><pre><code>(venv) PS C:\Uthumer
</code></pre><p>Run the below to actually install the wrapper:</p><pre><code>pip install google-api-python-client
</code></pre><h2 id=repl-i-stylecolor-red-classheart-fas-fa-hearti>REPL</h2><p>Seriously, I think that it&rsquo;s one of the best things about Python. It allows you to test all your crazy ideas in sandbox manner. I always have it open while I work on my code, as it helps me to figure out empirically how a certain method behaves. It also simplifies comming up with an algorithm, as it allows you to examine a code snippet in isolation. The fact that it evaluates your expressions as you enter them (that&rsquo;s what <a href=https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop>REPL</a> stands for) means responsiveness and it makes the whole experience enjoyably fluid.</p><p>You can <a href=https://docs.python.org/3/tutorial/interpreter.html#interactive-mode>invoke it</a> by typing the following command in your favorite shell:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>python</code></pre></div><p>Et voil√†! In a moment you will see how deep the rabbit hole goes but for now why don&rsquo;t we play with it a little? The following snippet of code would make it memorize a value assigned to a variable:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>var <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>
var
<span style=color:#ae81ff>5</span></code></pre></td></tr></table></div></div><p><code>1.</code> Assigning a variable. I&rsquo;m the guy who documents getters and setters in his code, by the way.</p><p><code>2.</code> An expression to evaluate. Because we reference a variable name, it would get substituted to <code>5</code> - the value that we previously assigned to it.</p><p><code>3.</code> Evaluated expression.</p><p>Multiline snippets of code are also possible - just press <code>Shift</code> + <code>Enter</code>. Keep in mind that <a href="https://docs.python.org/3/faq/design.html?highlight=indentation#why-does-python-use-indentation-for-grouping-of-statements">identation</a> is still a necessity. This little conditional statement should print <em>5 = 5!</em>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>if</span> var <span style=color:#f92672>is</span> <span style=color:#ae81ff>5</span>:
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#39;5 = 5!&#39;</span>)
</code></pre></div><p>I deeply and profoundly love this workflow. I hope that it would charm you, too! We are going to get familiar with it&rsquo;s real power shortly.</p><h2 id=interacting-with-the-api>Interacting with the API</h2><p>When it comes to our little utility, we could use the REPL to get acustomed with our wrapper. Let&rsquo;s try it out, shall we? As documented on <a href=https://github.com/googleapis/google-api-python-client/blob/master/docs/start.md#build-the-service-object>the docs page</a>, we have to import the library first and then use it&rsquo;s <code>build</code> method to obtain a service object <strong>(our wrapper)</strong>. It takes a couple of parameters, incuding the API key that we have already received.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> googleapiclient.discovery <span style=color:#f92672>import</span> build
api_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;developerKey&#39;</span>: <span style=color:#e6db74>&#39;YOUR_API_KEY&#39;</span>, <span style=color:#e6db74>&#39;serviceName&#39;</span>: <span style=color:#e6db74>&#39;youtube&#39;</span>, <span style=color:#e6db74>&#39;version&#39;</span>: <span style=color:#e6db74>&#39;v3&#39;</span>}
api <span style=color:#f92672>=</span> build(<span style=color:#f92672>**</span>api_params)</code></pre></td></tr></table></div></div><p><code>1.</code> Import the method from the library (note the modified module name) that returns the wrapper object.</p><p><code>2.</code> Specify method parameters.</p><p><code>3.</code> Build the wrapper object using the <a href=https://docs.python.org/3.8/tutorial/controlflow.html#unpacking-argument-lists>unpacked</a> <code>api_params</code> dictionary defined before. It equals to the code below:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>api <span style=color:#f92672>=</span> build(developerKey<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;YOUR_API_KEY&#39;</span>, serviceName<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;youtube&#39;</span>, version<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;v3&#39;</span>)
</code></pre></div><p>I know, right? Given <a href=https://docs.python.org/3/tutorial/controlflow.html#keyword-arguments>keyword arguments</a> order is not important, it makes for some flexible function calls. It rocks&mldr; until you have to <a href=https://docs.python.org/3/library/unittest.mock.html>mock</a> it. Or maybe it&rsquo;s just me?</p><p>Great success! You have just builded your wrapper object! Now that we have it, we can use it to obtain thumbnail links. In terms of the API client that we use, <a href=https://developers.google.com/youtube/v3/docs/videos><code>videos</code></a> is the collection that we will be working with. <a href=https://developers.google.com/youtube/v3/docs/videos#resource>Here</a> you can see full specification of it&rsquo;s structure, albeit we are only interested in a <a href=https://developers.google.com/youtube/v3/docs/thumbnails><code>['snippet']['thumbnails']</code></a> key. It can be obtained through <a href=https://developers.google.com/youtube/v3/docs/videos/list><code>list</code></a> method. Roughly it would translate to the following Python code:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>request <span style=color:#f92672>=</span> service<span style=color:#f92672>.</span>videos()<span style=color:#f92672>.</span>list()
</code></pre></div><p>Executing the code would raise an exception that we didn&rsquo;t provide enough parameters to the <code>list</code> method. We are going to handle it in a moment. <a href=https://developers.google.com/youtube/v3/getting-started#partial-examples>An example</a> (the 4th one) provided in - lo and behold - the docs gave me an idea what parameters should I pass in order to obtain metadata that interest me. It speaks of the following URL:</p><pre><code>https://www.googleapis.com/youtube/v3/videos?id=7lCDEYXw3mM&amp;key=YOUR_API_KEY&amp;fields=items(id,snippet(channelId,title,categoryId),statistics)&amp;part=snippet,statistics
</code></pre><p>Phew. Let&rsquo;s break it down a bit and look at it from the Python perspective. Our <a href=https://en.wikipedia.org/wiki/URL>query</a> consist of a couple of variables:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>id <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;7lCDEYXw3mM&#39;</span>
key <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;YOUR_API_KEY&#39;</span>
part <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;snippet,statistics&#39;</span>
fields <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;items(id,snippet(channelId,title,categoryId),statistics)&#39;</span></code></pre></td></tr></table></div></div><p><code>1.</code> Youtube Video ID.</p><p><code>2.</code> Your API key.</p><p><code>3.</code> Here we specify first level keys which fields interest us. We can further pinpoint them using <em>fields</em> variable.</p><p><code>4.</code> Metdata about video(s) that you are wishing to obtain. They are maped directly to <a href=https://developers.google.com/youtube/v3/docs/videos#resource-representation>the response</a> fields that you are going to get.</p><p>You can easily compare the output with <a href="https://www.youtube.com/watch?v=7lCDEYXw3mM">the video</a> utilized by the example. More so, it&rsquo;s perfectly possible to visit this link using your browser. You would see the following <a href=http://www.json.org/>JSON</a> response:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
 <span style=color:#f92672>&#34;videos&#34;</span>: [
  {
   <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;7lCDEYXw3mM&#34;</span>,
   <span style=color:#f92672>&#34;snippet&#34;</span>: {
    <span style=color:#f92672>&#34;channelId&#34;</span>: <span style=color:#e6db74>&#34;UC_x5XG1OV2P6uZZ5FSM9Ttw&#34;</span>,
    <span style=color:#f92672>&#34;title&#34;</span>: <span style=color:#e6db74>&#34;Google I/O 101: Q&amp;A On Using Google APIs&#34;</span>,
    <span style=color:#f92672>&#34;categoryId&#34;</span>: <span style=color:#e6db74>&#34;28&#34;</span>
   },
   <span style=color:#f92672>&#34;statistics&#34;</span>: {
    <span style=color:#f92672>&#34;viewCount&#34;</span>: <span style=color:#e6db74>&#34;3057&#34;</span>,
    <span style=color:#f92672>&#34;likeCount&#34;</span>: <span style=color:#e6db74>&#34;25&#34;</span>,
    <span style=color:#f92672>&#34;dislikeCount&#34;</span>: <span style=color:#e6db74>&#34;0&#34;</span>,
    <span style=color:#f92672>&#34;favoriteCount&#34;</span>: <span style=color:#e6db74>&#34;17&#34;</span>,
    <span style=color:#f92672>&#34;commentCount&#34;</span>: <span style=color:#e6db74>&#34;12&#34;</span>
   }
  }
 ]
}
</code></pre></div><p>Quite obviously the response is not what we were wishing to get, although I think that it gives a rough idea how the API works and how would we use it to get the data that we want. Please, look at our <a href=https://developers.google.com/youtube/v3/docs/videos#resource-representation>resource representation</a> once again. We are interested in a <code>snippet</code> part because that&rsquo;s where we can find <code>thumbnails</code> field. Knowing how the previous query relates to the response returned by the API, we should be able to get our thumbnails through passing the following query parameters:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>id <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;U-iEK0mlmuQ&#39;</span>
key <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;YOUR_API_KEY&#39;</span>
part <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;snippet&#39;</span>
fields <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;items(snippet(thumbnails))&#39;</span>
</code></pre></div><p>Let&rsquo;s return to our benelovent REPL and see if we are right. The parameters above directly translates to Python code and they could be directly pasted into our interactive console, albeit I&rsquo;m going to pack them into a dictionary like I did when I had builded the wrapper object:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>request_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#e6db74>&#39;U-iEK0mlmuQ&#39;</span>,
                  <span style=color:#e6db74>&#39;part&#39;</span>: <span style=color:#e6db74>&#39;snippet&#39;</span>,
                  <span style=color:#e6db74>&#39;fields&#39;</span>: <span style=color:#e6db74>&#39;items(snippet(thumbnails))&#39;</span>}
request <span style=color:#f92672>=</span> api<span style=color:#f92672>.</span>videos()<span style=color:#f92672>.</span>list(<span style=color:#f92672>**</span>request_params)
</code></pre></div><p>The last step is to actually execute our query. In order to do that, we are asked to use the <code>execute</code> method:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>response <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>execute()
</code></pre></div><p>As I wrote in the previous section, we can access the variable value by simply entering it&rsquo;s name into REPL:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>response
{<span style=color:#e6db74>&#39;items&#39;</span>: [{<span style=color:#e6db74>&#39;snippet&#39;</span>: {<span style=color:#e6db74>&#39;thumbnails&#39;</span>: {<span style=color:#e6db74>&#39;default&#39;</span>: {<span style=color:#e6db74>&#39;url&#39;</span>: <span style=color:#e6db74>&#39;https://i.ytimg.com/vi/U-iEK0mlmuQ/default.jpg&#39;</span>, <span style=color:#e6db74>&#39;width&#39;</span>: <span style=color:#ae81ff>120</span>, <span style=color:#e6db74>&#39;height&#39;</span>: <span style=color:#ae81ff>90</span>}, <span style=color:#e6db74>&#39;medium&#39;</span>: {<span style=color:#e6db74>&#39;url&#39;</span>: <span style=color:#e6db74>&#39;https://i.ytimg.com/vi/U-iEK0mlmuQ/mqdefault.jpg&#39;</span>, <span style=color:#e6db74>&#39;width&#39;</span>: <span style=color:#ae81ff>320</span>, <span style=color:#e6db74>&#39;height&#39;</span>: <span style=color:#ae81ff>180</span>}, <span style=color:#e6db74>&#39;high&#39;</span>: {<span style=color:#e6db74>&#39;url&#39;</span>: <span style=color:#e6db74>&#39;https://i.ytimg.com/vi/U-iEK0mlmuQ/hqdefault.jpg&#39;</span>, <span style=color:#e6db74>&#39;width&#39;</span>: <span style=color:#ae81ff>480</span>, <span style=color:#e6db74>&#39;height&#39;</span>: <span style=color:#ae81ff>360</span>}, <span style=color:#e6db74>&#39;standard&#39;</span>: {<span style=color:#e6db74>&#39;url&#39;</span>: <span style=color:#e6db74>&#39;https://i.ytimg.com/vi/U-iEK0mlmuQ/sddefault.jpg&#39;</span>, <span style=color:#e6db74>&#39;width&#39;</span>: <span style=color:#ae81ff>640</span>, <span style=color:#e6db74>&#39;height&#39;</span>: <span style=color:#ae81ff>480</span>}, <span style=color:#e6db74>&#39;maxres&#39;</span>: {<span style=color:#e6db74>&#39;url&#39;</span>: <span style=color:#e6db74>&#39;https://i.ytimg.com/vi/U-iEK0mlmuQ/maxresdefault.jpg&#39;</span>, <span style=color:#e6db74>&#39;width&#39;</span>: <span style=color:#ae81ff>1280</span>, <span style=color:#e6db74>&#39;height&#39;</span>: <span style=color:#ae81ff>720</span>}}}}]}
</code></pre></div><p>Uh oh. Not the most decipherable output, isn&rsquo;t it? Worry not! We can use lovely <a href=https://docs.python.org/3/library/json.html><code>json</code></a> library to make it more human-readable. Try the following snippet of code:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> json
formatted_response <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>dumps(response, indent<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
<span style=color:#66d9ef>print</span>(formatted_response)
{
  <span style=color:#e6db74>&#34;items&#34;</span>: [
    {
      <span style=color:#e6db74>&#34;snippet&#34;</span>: {
        <span style=color:#e6db74>&#34;thumbnails&#34;</span>: {
          <span style=color:#e6db74>&#34;default&#34;</span>: {
            <span style=color:#e6db74>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://i.ytimg.com/vi/U-iEK0mlmuQ/default.jpg&#34;</span>,
            <span style=color:#e6db74>&#34;width&#34;</span>: <span style=color:#ae81ff>120</span>,
            <span style=color:#e6db74>&#34;height&#34;</span>: <span style=color:#ae81ff>90</span>
          },
          <span style=color:#e6db74>&#34;medium&#34;</span>: {
            <span style=color:#e6db74>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://i.ytimg.com/vi/U-iEK0mlmuQ/mqdefault.jpg&#34;</span>,
            <span style=color:#e6db74>&#34;width&#34;</span>: <span style=color:#ae81ff>320</span>,
            <span style=color:#e6db74>&#34;height&#34;</span>: <span style=color:#ae81ff>180</span>
          },
          <span style=color:#e6db74>&#34;high&#34;</span>: {
            <span style=color:#e6db74>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://i.ytimg.com/vi/U-iEK0mlmuQ/hqdefault.jpg&#34;</span>,
            <span style=color:#e6db74>&#34;width&#34;</span>: <span style=color:#ae81ff>480</span>,
            <span style=color:#e6db74>&#34;height&#34;</span>: <span style=color:#ae81ff>360</span>
          },
          <span style=color:#e6db74>&#34;standard&#34;</span>: {
            <span style=color:#e6db74>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://i.ytimg.com/vi/U-iEK0mlmuQ/sddefault.jpg&#34;</span>,
            <span style=color:#e6db74>&#34;width&#34;</span>: <span style=color:#ae81ff>640</span>,
            <span style=color:#e6db74>&#34;height&#34;</span>: <span style=color:#ae81ff>480</span>
          },
          <span style=color:#e6db74>&#34;maxres&#34;</span>: {
            <span style=color:#e6db74>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://i.ytimg.com/vi/U-iEK0mlmuQ/maxresdefault.jpg&#34;</span>,
            <span style=color:#e6db74>&#34;width&#34;</span>: <span style=color:#ae81ff>1280</span>,
            <span style=color:#e6db74>&#34;height&#34;</span>: <span style=color:#ae81ff>720</span>
          }
        }
      }
    }
  ]
}</code></pre></td></tr></table></div></div><p><code>1.</code> Import <code>json</code> library that we will use to receive pretty, formatted output. It&rsquo;s a part of vast <a href=https://docs.python.org/3/library/>Python standard library</a>, which I find cool on it&rsquo;s own.</p><p><code>2.</code> Create output string. The <em>indent</em> parameter tells us that each level will be indented using 2 spaces.</p><p><code>3.</code> Print our response on the console.</p><p><code>4.</code> Formatted output.</p><p>Much better! In order to make navigating over thumbnails entries a little more convenient, I&rsquo;m going to assign appropriate key under corresponding variable:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>thumbs <span style=color:#f92672>=</span> response[<span style=color:#e6db74>&#39;items&#39;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;snippet&#39;</span>][<span style=color:#e6db74>&#39;thumbnails&#39;</span>]
formatted_thumbs <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>dumps(thumbs, indent<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
<span style=color:#66d9ef>print</span>(formatted_thumbs)
{
  <span style=color:#e6db74>&#34;default&#34;</span>: {
    <span style=color:#e6db74>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://i.ytimg.com/vi/U-iEK0mlmuQ/default.jpg&#34;</span>,
    <span style=color:#e6db74>&#34;width&#34;</span>: <span style=color:#ae81ff>120</span>,
    <span style=color:#e6db74>&#34;height&#34;</span>: <span style=color:#ae81ff>90</span>
  },
  <span style=color:#e6db74>&#34;medium&#34;</span>: {
    <span style=color:#e6db74>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://i.ytimg.com/vi/U-iEK0mlmuQ/mqdefault.jpg&#34;</span>,
    <span style=color:#e6db74>&#34;width&#34;</span>: <span style=color:#ae81ff>320</span>,
    <span style=color:#e6db74>&#34;height&#34;</span>: <span style=color:#ae81ff>180</span>
  },
  <span style=color:#e6db74>&#34;high&#34;</span>: {
    <span style=color:#e6db74>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://i.ytimg.com/vi/U-iEK0mlmuQ/hqdefault.jpg&#34;</span>,
    <span style=color:#e6db74>&#34;width&#34;</span>: <span style=color:#ae81ff>480</span>,
    <span style=color:#e6db74>&#34;height&#34;</span>: <span style=color:#ae81ff>360</span>
  },
  <span style=color:#e6db74>&#34;standard&#34;</span>: {
    <span style=color:#e6db74>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://i.ytimg.com/vi/U-iEK0mlmuQ/sddefault.jpg&#34;</span>,
    <span style=color:#e6db74>&#34;width&#34;</span>: <span style=color:#ae81ff>640</span>,
    <span style=color:#e6db74>&#34;height&#34;</span>: <span style=color:#ae81ff>480</span>
  },
  <span style=color:#e6db74>&#34;maxres&#34;</span>: {
    <span style=color:#e6db74>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://i.ytimg.com/vi/U-iEK0mlmuQ/maxresdefault.jpg&#34;</span>,
    <span style=color:#e6db74>&#34;width&#34;</span>: <span style=color:#ae81ff>1280</span>,
    <span style=color:#e6db74>&#34;height&#34;</span>: <span style=color:#ae81ff>720</span>
  }
}</code></pre></td></tr></table></div></div><p><code>1.</code> I think that navigating over lists and dictionaries in Python is pretty straighforward, although I&rsquo;m going to explain it a bit for the sake of clarity. The value under <code>items</code> key is a list (think of it as of an array - they behave the same in this example) which is denoted by <code>[</code> and <code>]</code> characters. It has only one item and Python list indices start from 0, so by typing <code>[0]</code> we will get what we want. The <code>snippet</code> resource which we reference using a <code>['snippet']</code> key contains one more object - <code>thumbnails</code>. There are images URLs that we are going to process.</p><p><code>2.</code> Format dictionary items that we have just extracted using 2 spaces indent.</p><p><code>3.</code> Display our data structure.</p><p><code>4.</code> Formatted output.</p><p>Before we can download our image, we need a way to determine which one is the biggest. Thumbnails come in different sizes depending on the video. Documentation for the resource <a href=https://developers.google.com/youtube/v3/docs/thumbnails>states</a> that it can return them in the following dimensions:</p><ul><li>default (120 x 90)</li><li>medium (320 x 180)</li><li>high (480 x 360)</li><li>standard (640 x 480)</li><li>maxres (1280 x 720)</li></ul><p>As you see we have received them all. Unfortunately we can&rsquo;t just assume that our video comes with all of the above and just download the <strong>maxres</strong> image. Some of them simply don&rsquo;t have it. For example an API request for the iconic <a href="https://www.youtube.com/watch?v=_OBlgSz8sSM"><em>Charlie bit my finger</em></a> yields only these:</p><ul><li><p>default (120 x 90)</p></li><li><p>medium (320 x 180)</p></li><li><p>high (480 x 360)</p></li><li><p><del>standard (640 x 480)</del></p></li><li><p><del>maxres (1280 x 720)</del></p></li></ul><p>Because the sizes returned by the API can vary I decided to find a way to make sure which one is the biggest. The simpliest approach that I can think of is to create an ordered list of sizes and check if the response has returned any of them. I think that I&rsquo;m okay to assume that I can rely on the default item order, although my inner paranoid yells at me to manually check which image is the biggest based on their dimensions in pixels. He would certainly benefit from an obesity diet, so I&rsquo;m just going to leave him to starve:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>SIZES <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;maxres&#39;</span>, <span style=color:#e6db74>&#39;standard&#39;</span>, <span style=color:#e6db74>&#39;high&#39;</span>, <span style=color:#e6db74>&#39;medium&#39;</span>, <span style=color:#e6db74>&#39;default&#39;</span>]
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_largest_thumb_url</span>(thumbs):
    <span style=color:#66d9ef>for</span> size <span style=color:#f92672>in</span> SIZES:
        <span style=color:#66d9ef>if</span> size <span style=color:#f92672>in</span> thumbs:
            thumb <span style=color:#f92672>=</span> thumbs[size]
            url <span style=color:#f92672>=</span> thumb[<span style=color:#e6db74>&#39;url&#39;</span>]
            <span style=color:#66d9ef>return</span> url
    <span style=color:#66d9ef>return</span> None
thumb_url <span style=color:#f92672>=</span> get_largest_thumb_url(thumbs)
thumb_url</code></pre></td></tr></table></div></div><p><code>1.</code> Define <a href=https://www.python.org/dev/peps/pep-0008/?#constants>constant</a> denoting images size order. They correspond with dictionary keys of previously defined <code>thumbs</code> variable.</p><p><code>2.</code> A function that returns an URL of the largest thumbnail based on a dictionary passed as it&rsquo;s parameter. Returns <code>None</code> if it contains no key specified above. I don&rsquo;t think that it may happen, but it&rsquo;s considered to be in good style, isn&rsquo;t it?</p><p><code>3.</code> Iterate over <code>SIZES</code> keys to find out if <code>thumbs</code> dictionary contain any of them.</p><p><code>4.</code> Check if a currently processed <code>size</code> key is present in <code>thumbs</code> dictionary.</p><p><code>5.</code> Because a key was found, get a value from <code>thumbs</code> dict that matches it and assign it to a temporary <code>thumb</code> variable.</p><p><code>6.</code> Get the <code>thumb</code>nail URL.</p><p><code>7.</code> Return the <code>thumb</code>nail <code>url</code>.</p><p><code>8.</code> Return <code>None</code> if <code>thumbs</code> contain no <code>size</code> key listed in the <code>SIZES</code>.</p><p><code>9.</code> Assign the largest thumb to a <code>thumb_url</code> variable.</p><p><code>10.</code> Display the URL.</p><p>Woah! Our first function! Now <em>that&rsquo;s</em> a reuputable tutorial! Now that we have it, we can finally download our image.</p><h2 id=finally-downloading-the-image>Finally downloading the image.</h2><p>I&rsquo;m going to use <code>request</code> module from <a href=https://docs.python.org/3/library/urllib.html><code>urllib</code></a> library to download the image. It comes with a convenient <a href=https://docs.python.org/3.0/library/urllib.request.html#urllib.request.urlretrieve><code>urlretrieve</code></a> method which is perfect for our use case. I was considering using <a href=http://docs.python-requests.org/en/master/><code>requests</code></a> library as it would do the job just as well. I decided to use <code>urllib</code> because it&rsquo;s a part of Python standard library (which is always a plus if you ask me) and it can download the file with just one line of code using a dedicated function. It&rsquo;s perfectly possible that <code>requests</code> provide such a method as well but I&rsquo;m simply not aware of it.</p><p>Given that you have been following the tutorial all along, all you have to do is to import the method from the <code>urllib</code> module and invoke it as shown below. It would retrieve the image from the Youtube server and save it under the name specified by <code>filename</code> variable:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> urllib.request <span style=color:#f92672>import</span> urlretrieve
filename <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;wallpaper.jpg&#39;</span>
urlretrieve(thumb_url, filename)
</code></pre></div><p><code>1.</code> Import the method that would enable us to simultaneously download and save the image.</p><p><code>2.</code> Specify the downloaded file name.</p><p><code>3.</code> Get the image under the URL assigned to the <code>thumb_url</code> variable and save it in the current directory under the name specified by <code>filename</code> variable.</p><p>Here it is. The downloaded image in the flesh.</p><p><img src=/img/posts/youtube-thumbnail-downloader/downloaded_image.png alt="Downloaded image"></p><h2 id=putting-it-all-together>Putting it all together.</h2><p>I think that would be nice if we saved our progress in a script file. This way we could reuse it in the future. I think that it is very likely given what the script does. Personally I use it on regular basis and I hope that you find it this useful, too!</p><p>Despite of you finding it handy, we are going to need the script file later on in order to pass some CLI parameters to it. Here&rsquo;s everything that we&rsquo;ve got so far (roughly in the order that we entered it into the interpreter):</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> googleapiclient.discovery <span style=color:#f92672>import</span> build
<span style=color:#f92672>from</span> urllib.request <span style=color:#f92672>import</span> urlretrieve
<span style=color:#f92672>import</span> json


api_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;developerKey&#39;</span>: <span style=color:#e6db74>&#39;YOUR_API_KEY&#39;</span>,
              <span style=color:#e6db74>&#39;serviceName&#39;</span>: <span style=color:#e6db74>&#39;youtube&#39;</span>,
              <span style=color:#e6db74>&#39;version&#39;</span>: <span style=color:#e6db74>&#39;v3&#39;</span>}
api <span style=color:#f92672>=</span> build(<span style=color:#f92672>**</span>api_params)

request_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#e6db74>&#39;U-iEK0mlmuQ&#39;</span>,
                  <span style=color:#e6db74>&#39;part&#39;</span>: <span style=color:#e6db74>&#39;snippet&#39;</span>,
                  <span style=color:#e6db74>&#39;fields&#39;</span>: <span style=color:#e6db74>&#39;items(snippet(thumbnails))&#39;</span>}
request <span style=color:#f92672>=</span> api<span style=color:#f92672>.</span>videos()<span style=color:#f92672>.</span>list(<span style=color:#f92672>**</span>request_params)
response <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>execute()
thumbs <span style=color:#f92672>=</span> response[<span style=color:#e6db74>&#39;items&#39;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;snippet&#39;</span>][<span style=color:#e6db74>&#39;thumbnails&#39;</span>]
formatted_thumbs <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>dumps(thumbs, indent<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
<span style=color:#66d9ef>print</span>(formatted_thumbs)

SIZES <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;maxres&#39;</span>, <span style=color:#e6db74>&#39;standard&#39;</span>, <span style=color:#e6db74>&#39;high&#39;</span>, <span style=color:#e6db74>&#39;medium&#39;</span>, <span style=color:#e6db74>&#39;default&#39;</span>]


<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_largest_thumb_url</span>(thumbs):
    <span style=color:#66d9ef>for</span> size <span style=color:#f92672>in</span> SIZES:
        <span style=color:#66d9ef>if</span> size <span style=color:#f92672>in</span> thumbs:
            thumb_url <span style=color:#f92672>=</span> thumbs[size][<span style=color:#e6db74>&#39;url&#39;</span>]
            <span style=color:#66d9ef>return</span> thumb_url
    <span style=color:#66d9ef>return</span> None


thumb_url <span style=color:#f92672>=</span> get_largest_thumb_url(thumbs)

filename <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;wallpaper.jpg&#39;</span>
urlretrieve(thumb_url, filename)</code></pre></td></tr></table></div></div><p>Just by looking at it I can&rsquo;t help but think that we need to immediately&mldr;</p><h2 id=refactor-it-with-fire>Refactor it with fire</h2><p>I love refactoring. As of lately I tend to write a rough draft first and worry about deploying it in methods and classes later on. I find it less streneous than diving right into <a href=https://en.wikipedia.org/wiki/Object-oriented_programming>OOP</a> and whatnot.</p><p>First of all I think that it would be nice if we removed test outputs and a reference to the <code>json</code> library as they will be no longer needed.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> googleapiclient.discovery <span style=color:#f92672>import</span> build
<span style=color:#f92672>from</span> urllib.request <span style=color:#f92672>import</span> urlretrieve
<span style=display:block;width:100%;background-color:#3c3d38><span style=color:#f92672>import</span> json</span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span></span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>thumbs <span style=color:#f92672>=</span> response[<span style=color:#e6db74>&#39;items&#39;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;snippet&#39;</span>][<span style=color:#e6db74>&#39;thumbnails&#39;</span>]
<span style=display:block;width:100%;background-color:#3c3d38>formatted_thumbs <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>dumps(thumbs, indent<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
</span><span style=display:block;width:100%;background-color:#3c3d38><span style=color:#66d9ef>print</span>(formatted_thumbs)</span></code></pre></td></tr></table></div></div><p>I think that it would be cool if we put getting the wrapper and obtaining thumbnails from the server into functions. Let&rsquo;s start with obtaining the API object first. This is the code that bothers me:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>api_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;developerKey&#39;</span>: <span style=color:#e6db74>&#39;YOUR_API_KEY&#39;</span>,
              <span style=color:#e6db74>&#39;serviceName&#39;</span>: <span style=color:#e6db74>&#39;youtube&#39;</span>,
              <span style=color:#e6db74>&#39;version&#39;</span>: <span style=color:#e6db74>&#39;v3&#39;</span>}
api <span style=color:#f92672>=</span> build(<span style=color:#f92672>**</span>api_params)</code></pre></td></tr></table></div></div><p>It depends on one parameter - your API key (assigned to a <code>developerKey</code> named parameter). Let&rsquo;s create a function that takes just that and returns a builded wrapper:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>API_KEY <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;YOUR_API_KEY&#39;</span>


<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_api</span>(api_key):
    api_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;developerKey&#39;</span>: api_key,
                  <span style=color:#e6db74>&#39;serviceName&#39;</span>: <span style=color:#e6db74>&#39;youtube&#39;</span>,
                  <span style=color:#e6db74>&#39;version&#39;</span>: <span style=color:#e6db74>&#39;v3&#39;</span>}
    api <span style=color:#f92672>=</span> build(<span style=color:#f92672>**</span>api_params)
    <span style=color:#66d9ef>return</span> api


api <span style=color:#f92672>=</span> get_api(API_KEY)</code></pre></td></tr></table></div></div><p><code>1.</code> Our API key. I decided to make it a constant, as I think that it&rsquo;s unlikely that it&rsquo;s going to change.</p><p><code>4.</code> Define a function that takes the API key as it&rsquo;s only positional parameter.</p><p><code>5.</code> Define wrapper parameters. Here we use our API key passed as a function argument, so it&rsquo;s no longer hard-coded.</p><p><code>8.</code> Build our wrapper using parameters specified before.</p><p><code>9.</code> Return the wrapper.</p><p><code>12.</code> Get the wrapper and assign it to <code>api</code> variable.</p><p>Neat! Now let&rsquo;s take care of receiving the thumbs. This is our little code:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>request_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#e6db74>&#39;U-iEK0mlmuQ&#39;</span>,
                  <span style=color:#e6db74>&#39;part&#39;</span>: <span style=color:#e6db74>&#39;snippet&#39;</span>,
                  <span style=color:#e6db74>&#39;fields&#39;</span>: <span style=color:#e6db74>&#39;items(snippet(thumbnails))&#39;</span>}
request <span style=color:#f92672>=</span> api<span style=color:#f92672>.</span>videos()<span style=color:#f92672>.</span>list(<span style=color:#f92672>**</span>request_params)
response <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>execute()
thumbs <span style=color:#f92672>=</span> response[<span style=color:#e6db74>&#39;items&#39;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;snippet&#39;</span>][<span style=color:#e6db74>&#39;thumbnails&#39;</span>]
</code></pre></div><p>It would be nice if we passed a video ID as a function argument. We will also need the wrapper object as it is required to execute our request. The refactored function would look like this:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>video_id <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;U-iEK0mlmuQ&#39;</span>


<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_thumbs</span>(api, video_id):
    request_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;id&#39;</span>: video_id,
                      <span style=color:#e6db74>&#39;part&#39;</span>: <span style=color:#e6db74>&#39;snippet&#39;</span>,
                      <span style=color:#e6db74>&#39;fields&#39;</span>: <span style=color:#e6db74>&#39;items(snippet(thumbnails))&#39;</span>}
    request <span style=color:#f92672>=</span> api<span style=color:#f92672>.</span>videos()<span style=color:#f92672>.</span>list(<span style=color:#f92672>**</span>request_params)
    response <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>execute()
    thumbs <span style=color:#f92672>=</span> response[<span style=color:#e6db74>&#39;items&#39;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;snippet&#39;</span>][<span style=color:#e6db74>&#39;thumbnails&#39;</span>]
    <span style=color:#66d9ef>return</span> thumbs


thumbs <span style=color:#f92672>=</span> get_thumbs(api, video_id)</code></pre></td></tr></table></div></div><p><code>4.</code> Define a function that returns thumbnails for a video given it&rsquo;s ID and using provided API wrapper.</p><p><code>5.</code> Define API endpoint parameters.. We are going to use a video ID provided as a function argument.</p><p><code>8.</code> Prepare a request that would get our thumbnails list.</p><p><code>9.</code> Execute the query.</p><p><code>10.</code> Extract thumbnails metadata from the response from the server.</p><p><code>11.</code> Return extracted thumbnails metadata.</p><p><code>14.</code> Get extracted thumbnails metadata and assign it to <code>thumbs</code> variable.</p><p>There are still a few steps left. As you might have already seen, the code interlaced with functions definitions doesn&rsquo;t look particularly good. We will eventually put all this in a dedicated class, but I suggest that we start with creating a method that downloads the video thumbnail. This is what we have so far:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span></span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span></span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span></span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span></span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> googleapiclient.discovery <span style=color:#f92672>import</span> build
<span style=color:#f92672>from</span> urllib.request <span style=color:#f92672>import</span> urlretrieve

API_KEY <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;YOUR_API_KEY&#39;</span>
SIZES <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;maxres&#39;</span>, <span style=color:#e6db74>&#39;standard&#39;</span>, <span style=color:#e6db74>&#39;high&#39;</span>, <span style=color:#e6db74>&#39;medium&#39;</span>, <span style=color:#e6db74>&#39;default&#39;</span>]


<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_api</span>(api_key):
    api_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;developerKey&#39;</span>: api_key,
                  <span style=color:#e6db74>&#39;serviceName&#39;</span>: <span style=color:#e6db74>&#39;youtube&#39;</span>,
                  <span style=color:#e6db74>&#39;version&#39;</span>: <span style=color:#e6db74>&#39;v3&#39;</span>}
    api <span style=color:#f92672>=</span> build(<span style=color:#f92672>**</span>api_params)
    <span style=color:#66d9ef>return</span> api


<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_thumbs</span>(api, video_id):
    request_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;id&#39;</span>: video_id,
                      <span style=color:#e6db74>&#39;part&#39;</span>: <span style=color:#e6db74>&#39;snippet&#39;</span>,
                      <span style=color:#e6db74>&#39;fields&#39;</span>: <span style=color:#e6db74>&#39;items(snippet(thumbnails))&#39;</span>}
    request <span style=color:#f92672>=</span> api<span style=color:#f92672>.</span>videos()<span style=color:#f92672>.</span>list(<span style=color:#f92672>**</span>request_params)
    response <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>execute()
    thumbs <span style=color:#f92672>=</span> response[<span style=color:#e6db74>&#39;items&#39;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;snippet&#39;</span>][<span style=color:#e6db74>&#39;thumbnails&#39;</span>]
    <span style=color:#66d9ef>return</span> thumbs


<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_largest_thumb_url</span>(thumbs):
    <span style=color:#66d9ef>for</span> size <span style=color:#f92672>in</span> SIZES:
        <span style=color:#66d9ef>if</span> size <span style=color:#f92672>in</span> thumbs:
            thumb_url <span style=color:#f92672>=</span> thumbs[size][<span style=color:#e6db74>&#39;url&#39;</span>]
            <span style=color:#66d9ef>return</span> thumb_url
    <span style=color:#66d9ef>return</span> None


api <span style=color:#f92672>=</span> get_api(API_KEY)
video_id <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;U-iEK0mlmuQ&#39;</span>
<span style=display:block;width:100%;background-color:#3c3d38>thumbs <span style=color:#f92672>=</span> get_thumbs(api, video_id)
</span><span style=display:block;width:100%;background-color:#3c3d38>thumb_url <span style=color:#f92672>=</span> get_largest_thumb_url(thumbs)
</span><span style=display:block;width:100%;background-color:#3c3d38>filename <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;wallpaper.jpg&#39;</span>
</span><span style=display:block;width:100%;background-color:#3c3d38>urlretrieve(thumb_url, filename)</span></code></pre></td></tr></table></div></div><p>As you can see, I have slightly altered the code. I believe that it&rsquo;s more readable and organized now. I decided to put our <code>SIZES</code> list at the top of the file. I think that this way it would be easy to find if there&rsquo;s a need to alter it. I have also made the <code>api_key</code> variable a constant and put it next to <code>SIZES</code> list. Additionally all functions definitions are now at the top of the document.</p><p>Using the highlighted lines from the listing above, I have came up with an idea for a function that downloads the thumbnail:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>download_thumb</span>(api, video_id, path<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;wallpaper.jpg&#39;</span>):
	thumbs <span style=color:#f92672>=</span> get_thumbs(api, video_id)
	thumb_url <span style=color:#f92672>=</span> get_largest_thumb_url(thumbs)
	urlretrieve(thumb_url, path)</code></pre></td></tr></table></div></div><p><code>1.</code> There are a couple of parameters here. Let&rsquo;s break them down:</p><ul><li><code>api</code> - as the function references other functions that we have defined before, we have to pass an api object, so that they can be properly invoked.</li><li><code>video_id</code> - an ID of a video</li><li><code>path</code> - a path to a saved file. I decided to rename it from <code>filename</code>. I have came up to a conclusion that <code>path</code> is more appropriate (sadly, <em>appropriatier</em> is not a word), as the file can be saved anywhere on your device. It <a href=https://docs.python.org/3/reference/compound_stmts.html#function-definitions>defaults</a> to <code>wallpaper.jpg</code>, which means that the file under that name would appear in the directory where you have fired the script.</li></ul><p><code>2.</code> Get thumbnails URLs for a given video referenced by it&rsquo;s ID.</p><p><code>3.</code> Get the largest thumbnail URL.</p><p><code>4.</code> Save the image using the path provided as a function parameter.</p><p>The last logical step would be to create a class that would wrap the code that we have just written. I think that the class concept is easiest to grasp when defined as a container for functions and variables. In that context the former turns into a <em>method</em> and the latter transforms into a <em>field</em>. Those terms are often interchangeable. Let&rsquo;s create one!</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Uthumer</span>:
    _api <span style=color:#f92672>=</span> None</code></pre></td></tr></table></div></div><p><code>1.</code> Define the aforementioned class. I have decided to name it Uthumler because it&rsquo;s a <em><strong>You</strong>tube</em> <em><strong>Thum</strong>bnail</em> <em>Download<strong>er</strong></em>. <em><strong>You</strong>tube</em>, hence <em>u</em>.</p><p><code>2.</code> Define a class variable for <a href=https://www.python.org/dev/peps/pep-0008/#id36>internal use</a>. Leading underscore basically means that you should not mess with the variable. We will definitely need the Youtube API to perform our query, even if it&rsquo;s <a href=https://docs.python.org/2/library/constants.html#None>empty</a> for now. We can access it using a dot operator, like so (though not recommended):</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>uthumler <span style=color:#f92672>=</span> Uthumler()
uthumler<span style=color:#f92672>.</span>_api</code></pre></td></tr></table></div></div><p><code>1.</code> Create an instance of our class - an object that gives us access to it&rsquo;s fields and
methods. We do this by using our class like a function. We can pass paremeters to it, but we don&rsquo;t need them right now.</p><p><code>2.</code> Get the <code>api</code> field value. It returns nothing, as it&rsquo;s value is <code>None</code>, which literally means that there is no value assigned! Actually it&rsquo;s value is set to an object of <code>NoneType</code> class, but let&rsquo;s stay in a fairyland a little bit longer.</p><p>Now that we are acquainted with classes and objects, let&rsquo;s obtain the API wrapper object. We can convienently copy the <code>get_api</code> method that we have written before, with some alterations:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Uthumer</span>:
    _api <span style=color:#f92672>=</span> None

    <span style=color:#a6e22e>@property</span>
    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>api</span>(self):
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>_api:
            api_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;developerKey&#39;</span>: API_KEY,
                          <span style=color:#e6db74>&#39;serviceName&#39;</span>: <span style=color:#e6db74>&#39;youtube&#39;</span>,
                          <span style=color:#e6db74>&#39;version&#39;</span>: <span style=color:#e6db74>&#39;v3&#39;</span>}
            self<span style=color:#f92672>.</span>_api <span style=color:#f92672>=</span> build(<span style=color:#f92672>**</span>api_params)
        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_api</code></pre></td></tr></table></div></div><p><code>5.</code> An annotation that makes the following method definition a <a href=https://docs.python.org/3/library/functions.html#property>property</a>. More on it below.</p><p><code>6.</code> The method that we <a href=https://docs.python.org/3/glossary.html#term-decorator>decorate</a>. Because we have just used the <code>@property</code> decorator, it has turned into a getter. It allows for the following trick:<div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>uthumler <span style=color:#f92672>=</span> Uthumler()
api <span style=color:#f92672>=</span> uthumler<span style=color:#f92672>.</span>api
type(api)</code></pre></td></tr></table></div></div></p><p><code>1.</code> Create an object of our class.</p><p><code>2.</code> Assign a value of it&rsquo;s <code>api</code> property to a variable of the same name. Note that while the names clash, there is no conflict because they have different <a href=https://docs.python.org/3/reference/executionmodel.html>scopes</a>.</p><p><code>3.</code> To make sure that I have ended up with a return value of the <code>api</code> property, I print it&rsquo;s value using a built-in <a href=https://docs.python.org/3.7/library/functions.html#type><code>type</code></a> function. It returns a <code>&lt;class 'googleapiclient.discovery.Resource'></code> object, which is exactly what the <code>api</code> property is supposed to return.</p><p>It&rsquo;s only argument is <code>self</code>. It&rsquo;s an internal reference that allows an object to access it&rsquo;s own fields and methods that can vary between objects. <a href=(https://docs.python.org/3.7/tutorial/classes.html#class-and-instance-variables)>This</a> documentation article describes it in greater depth.</p><p>Let&rsquo;s put the rest of our methods in our class, with slight alterations:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span></span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span></span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span></span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span></span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> googleapiclient.discovery <span style=color:#f92672>import</span> build
<span style=color:#f92672>from</span> urllib.request <span style=color:#f92672>import</span> urlretrieve

API_KEY <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;YOUR_API_KEY&#39;</span>
SIZES <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;maxres&#39;</span>, <span style=color:#e6db74>&#39;standard&#39;</span>, <span style=color:#e6db74>&#39;high&#39;</span>, <span style=color:#e6db74>&#39;medium&#39;</span>, <span style=color:#e6db74>&#39;default&#39;</span>]

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Uthumer</span>:
    _api <span style=color:#f92672>=</span> None

    <span style=color:#a6e22e>@property</span>
    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>api</span>(self):
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>_api:
            api_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;developerKey&#39;</span>: API_KEY,
                          <span style=color:#e6db74>&#39;serviceName&#39;</span>: <span style=color:#e6db74>&#39;youtube&#39;</span>,
                          <span style=color:#e6db74>&#39;version&#39;</span>: <span style=color:#e6db74>&#39;v3&#39;</span>}
            self<span style=color:#f92672>.</span>_api <span style=color:#f92672>=</span> build(<span style=color:#f92672>**</span>api_params)
        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_api

    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_thumbs</span>(self, video_id):
        request_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;id&#39;</span>: video_id,
                          <span style=color:#e6db74>&#39;part&#39;</span>: <span style=color:#e6db74>&#39;snippet&#39;</span>,
                          <span style=color:#e6db74>&#39;fields&#39;</span>: <span style=color:#e6db74>&#39;items(snippet(thumbnails))&#39;</span>}
        request <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>api<span style=color:#f92672>.</span>videos()<span style=color:#f92672>.</span>list(<span style=color:#f92672>**</span>request_params)
        response <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>execute()
        thumbs <span style=color:#f92672>=</span> response[<span style=color:#e6db74>&#39;items&#39;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;snippet&#39;</span>][<span style=color:#e6db74>&#39;thumbnails&#39;</span>]
        <span style=color:#66d9ef>return</span> thumbs

    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_largest_thumb_url</span>(self, thumbs):
        <span style=color:#66d9ef>for</span> size <span style=color:#f92672>in</span> SIZES:
            <span style=color:#66d9ef>if</span> size <span style=color:#f92672>in</span> thumbs:
                thumb_url <span style=color:#f92672>=</span> thumbs[size][<span style=color:#e6db74>&#39;url&#39;</span>]
                <span style=color:#66d9ef>return</span> thumb_url
        <span style=color:#66d9ef>return</span> None

    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>download_thumb</span>(self, video_id, path<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;wallpaper.jpg&#39;</span>):
        thumbs <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>get_thumbs(video_id)
        thumb_url <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>get_largest_thumb_url(thumbs)
        urlretrieve(thumb_url, path)

<span style=display:block;width:100%;background-color:#3c3d38><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span><span style=display:block;width:100%;background-color:#3c3d38>    uthumer <span style=color:#f92672>=</span> Uthumer()
</span><span style=display:block;width:100%;background-color:#3c3d38>    video_id <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;U-iEK0mlmuQ&#39;</span>
</span><span style=display:block;width:100%;background-color:#3c3d38>    uthumer<span style=color:#f92672>.</span>download_thumb(video_id)</span></code></pre></td></tr></table></div></div><p>Highlighted code is going to be executed only when we invoke the script from CLI, as documented <a href=https://docs.python.org/3/library/__main__.html>here</a>. It wouldn&rsquo;t be executed if a script is imported as a module (which isn&rsquo;t our usecase anyways).</p><p>We will need one more method to extract video ID from an URL. It may look like this:</p><p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_video_id</span>(self, url):
    sanitized_url <span style=color:#f92672>=</span> url<span style=color:#f92672>.</span>strip(<span style=color:#e6db74>&#39;/&#39;</span>)
    <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;youtu.be&#39;</span> <span style=color:#f92672>in</span> sanitized_url:
        id <span style=color:#f92672>=</span> sanitized_url<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;youtu.be/&#39;</span>)[<span style=color:#ae81ff>1</span>]
    <span style=color:#66d9ef>else</span>:
        id <span style=color:#f92672>=</span> sanitized_url<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;watch?v=&#39;</span>)[<span style=color:#ae81ff>1</span>]
    <span style=color:#66d9ef>return</span> id</code></pre></td></tr></table></div></div><code>1.</code> Our class method that takes Youtube video URL as a parameter.</p><p><code>2.</code> Sanitize the URL so it doesn&rsquo;t contain character we don&rsquo;t want.</p><p><code>3.</code> Check if it&rsquo;s a shortened URL.</p><p><code>4.</code> Split the URL on <code>youtu.be/</code>, leaving us with a list that contains our ID on first (<code>[1]</code>) position. This can be checked experimentally using REPL:</p><p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;https://youtu.be/DPJjOgg10QU&#39;</span> 
sanitized_url <span style=color:#f92672>=</span> url<span style=color:#f92672>.</span>strip(<span style=color:#e6db74>&#39;/&#39;</span>)
<span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;youtu.be&#39;</span> <span style=color:#f92672>in</span> sanitized_url:
    id <span style=color:#f92672>=</span> sanitized_url<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;youtu.be/&#39;</span>)[<span style=color:#ae81ff>1</span>]
<span style=color:#66d9ef>else</span>:
    id <span style=color:#f92672>=</span> sanitized_url<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;watch?v=&#39;</span>)[<span style=color:#ae81ff>1</span>]
id</code></pre></td></tr></table></div></div><code>7.</code> Display our ID.</p><h1 id=config>Config</h1><p>We are going to implement config using python built-in <code>configparser</code> module. Let&rsquo;s create a new <code>settings.ini</code> file and put out settings in it:</p><p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>[youtube]
API_KEY <span style=color:#f92672>=</span> YOUR_API_KEY
SIZES <span style=color:#f92672>=</span> maxres,standard,high,medium,default</code></pre></td></tr></table></div></div><code>1.</code> Define a <code>youtube</code> group.</p><p><code>2.</code> Add your API key.</p><p><code>3.</code> Define sizes. Since it&rsquo;s not a Python file, we do not define it as a list per se, but as comma-separated sequence. We are going to parse it in a moment.</p><p>Now we need to refactor <code>Uthumer</code> class to introduce the changes:</p><p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span></span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span></span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span></span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Uthumer</span>:
    _api <span style=color:#f92672>=</span> None
<span style=display:block;width:100%;background-color:#3c3d38>    settings <span style=color:#f92672>=</span> ConfigParser()
</span><span style=display:block;width:100%;background-color:#3c3d38>    settings<span style=color:#f92672>.</span>read(<span style=color:#e6db74>&#39;settings.ini&#39;</span>)
</span>
    <span style=color:#a6e22e>@property</span>
    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>api</span>(self):
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>_api:
<span style=display:block;width:100%;background-color:#3c3d38>            api_params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;developerKey&#39;</span>: self<span style=color:#f92672>.</span>settings[<span style=color:#e6db74>&#39;youtube&#39;</span>][<span style=color:#e6db74>&#39;API_KEY&#39;</span>],
</span>                          <span style=color:#e6db74>&#39;serviceName&#39;</span>: <span style=color:#e6db74>&#39;youtube&#39;</span>,
                          <span style=color:#e6db74>&#39;version&#39;</span>: <span style=color:#e6db74>&#39;v3&#39;</span>}
            self<span style=color:#f92672>.</span>_api <span style=color:#f92672>=</span> build(<span style=color:#f92672>**</span>api_params)
        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_api

<span style=color:#f92672>...</span>

    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_largest_thumb_url</span>(self, thumbs):
<span style=display:block;width:100%;background-color:#3c3d38>        <span style=color:#66d9ef>for</span> size <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>settings[<span style=color:#e6db74>&#39;youtube&#39;</span>][<span style=color:#e6db74>&#39;SIZES&#39;</span>]<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;,&#39;</span>):
</span>            <span style=color:#66d9ef>if</span> size <span style=color:#f92672>in</span> thumbs:
                thumb_url <span style=color:#f92672>=</span> thumbs[size][<span style=color:#e6db74>&#39;url&#39;</span>]
                <span style=color:#66d9ef>return</span> thumb_url
        <span style=color:#66d9ef>return</span> None</code></pre></td></tr></table></div></div><code>3.</code> Here we create an object of <code>ConfigParser</code> class. Since we don&rsquo;t use it for anything fancy, we don&rsquo;t need to pass any variables to it.</p><p><code>9.</code> Use API key saved in an <code>API_KEY</code> key of <code>youtube</code> settings group.</p><p><code>18.</code> Split sizes list on a comma. It returns a Python list like we used before.</p><p>Done! Python abstractify configs really well. We needed only a few lines of code to achieve what we wanted.</p><h1 id=cli>CLI</h1><p>Adding CLI functionality is pretty straightforward, too. Modify the script like so:</p><p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>...</span>

<span style=color:#f92672>import</span> argparse

<span style=color:#f92672>...</span>

<span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
    uthumer <span style=color:#f92672>=</span> Uthumer()
    parser <span style=color:#f92672>=</span> argparse<span style=color:#f92672>.</span>ArgumentParser(description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Downloads a Youtube video thumbnail.&#34;</span>)
    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;url&#39;</span>,
                        help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Youtube video URL&#39;</span>,
                        default<span style=color:#f92672>=</span>None)
    parser_args <span style=color:#f92672>=</span> parser<span style=color:#f92672>.</span>parse_args()
    url <span style=color:#f92672>=</span> parser_args<span style=color:#f92672>.</span>url
    <span style=color:#66d9ef>if</span> url:
        video_id <span style=color:#f92672>=</span> uthumer<span style=color:#f92672>.</span>get_video_id(url)
        uthumer<span style=color:#f92672>.</span>download_thumb(video_id)</code></pre></td></tr></table></div></div><code>3.</code> Import <a href=https://docs.python.org/3/library/argparse.html>needed</a> library.</p><p><code>9.</code> Create a parser object and add custom description to it.</p><p><code>10.</code> Add an <code>url</code> argument to the parser.</p><p><code>11.</code> <code>url</code> help message.</p><p><code>12.</code> <code>url</code> default value if not passed.</p><p><code>13.</code> Get arguments.</p><p><code>14.</code> Get <code>url</code> from the arguments.</p><p><code>15.</code> Run code if <code>url</code> has been passed. Default <code>argparse</code> error message will be displayed if no <code>url</code> has been detected.</p><p><code>16.</code> Get video ID using the method that we created before.</p><p><code>17.</code> Download the thumbnail.</p><h1 id=final-words>Final words</h1><p>The tutorial is over. It came lenghty for a problem this simple. I think that it will make it appeal to beginners better. I made such thing for the first time and I wanted to pour all my knowledge into it. I hope that you enjoyed it!</p></div><footer class=post-footer><ul class=post-tags><li><a href=/tags/python/>Python</a></li><li><a href=/tags/api/>API</a></li><li><a href=/tags/http/>HTTP</a></li><li><a href=/tags/cli/>CLI</a></li><li><a href=/tags/repl/>REPL</a></li><li><a href=/tags/tutorial/>Tutorial</a></li></ul></footer><div class=cd>&#x1F4BF;</div></article></main><footer class=footer><span>Made with <i style=color:red class="fas fa-heart"></i>by
<a href=/about>Bartosz "izdwuut" Konikiewicz</a></span>
<span>&#183;</span>
<span><a href=https://github.com/izdwuut/izdwuut.github.io/tree/dev><img src=/img/github.png class=service-logo> Sources (MIT license)</a></span>
<span>&#183;</span>
<span>Fueled by <a href=https://gohugo.io/ target=_blank><img src=/img/hugo.svg class=service-logo></a>Ô∏è</span></footer><div id=overlay></div><div class=funny-bits></div><script src=/js/bundle.min.4dbe5443171a6f71eaf447210187832a2f892b495e9b77b7f78bf37532a8e11b.js integrity="sha256-Tb5UQxcab3Hq9EchAYeDKi+JK0lem3e394vzdTKo4Rs="></script><script data-no-instant>InstantClick.init();</script></body></html>